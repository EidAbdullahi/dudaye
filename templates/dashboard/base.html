{% load static %}
<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}Health Insurance Dashboard{% endblock %}</title>

  <!-- TailwindCSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Inter font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Lucide icons -->
  <script src="https://unpkg.com/lucide@latest"></script>

  <style>
    body { font-family: 'Inter', sans-serif; }
    .sidebar-link.active {
      background: linear-gradient(90deg, #2563eb, #3b82f6);
      color: white !important;
    }
    .sidebar-link.active i {
      color: white !important;
    }
  </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition">

  <!-- NAVBAR -->
  <nav class="bg-white dark:bg-gray-800 shadow-md px-6 py-3 flex justify-between items-center sticky top-0 z-30">
    <div class="flex items-center space-x-3">
      <i data-lucide="shield-check" class="w-6 h-6 text-blue-600"></i>
      <span class="font-bold text-lg">Health<span class="text-blue-600">Insure</span></span>
    </div>

    <div class="flex items-center space-x-4">
      <button id="darkModeToggle" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition">
        <i data-lucide="moon" class="w-5 h-5"></i>
      </button>

      <!-- Profile Dropdown -->
      <div class="relative group">
        <button class="flex items-center space-x-2 focus:outline-none">
          <i data-lucide="user" class="w-5 h-5 text-gray-500 dark:text-gray-300"></i>
          <span>{{ user.username|capfirst }}</span>
          <i data-lucide="chevron-down" class="w-4 h-4 text-gray-400 group-hover:rotate-180 transition"></i>
        </button>
        <div class="absolute right-0 mt-2 hidden group-hover:block bg-white dark:bg-gray-800 rounded-lg shadow-lg w-44 z-20">
          <div class="border-b border-gray-200 dark:border-gray-700 px-4 py-2 text-xs text-gray-500 dark:text-gray-400">
            Role: {{ user.role|default:"User" }}
          </div>
          <a href="{% url 'accounts:logout' %}" class="block px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700">Logout</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- LAYOUT WRAPPER -->
  <div class="flex min-h-screen">

    <!-- SIDEBAR -->
    <aside class="hidden md:flex flex-col w-64 bg-white dark:bg-gray-800 h-screen shadow-lg p-4 space-y-2 sticky top-0">
      
      <a href="{% url 'accounts:dashboard' %}" 
         class="sidebar-link flex items-center space-x-3 px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 
         {% if request.path == '/dashboard/' %}active{% endif %}">
        <i data-lucide="layout-dashboard" class="w-5 h-5 text-blue-600"></i>
        <span>Dashboard</span>
      </a>

      <a href="{% url 'clients:client_list' %}" 
         class="sidebar-link flex items-center space-x-3 px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 
         {% if '/clients/' in request.path %}active{% endif %}">
        <i data-lucide="users" class="w-5 h-5 text-green-600"></i>
        <span>Clients</span>
      </a>

      <a href="{% url 'policies:policy_list' %}" 
         class="sidebar-link flex items-center space-x-3 px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 
         {% if '/policies/' in request.path %}active{% endif %}">
        <i data-lucide="file-text" class="w-5 h-5 text-yellow-600"></i>
        <span>Policies</span>
      </a>

      <a href="{% url 'claims:claim_list' %}" 
         class="sidebar-link flex items-center space-x-3 px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 
         {% if '/claims/' in request.path %}active{% endif %}">
        <i data-lucide="clipboard-check" class="w-5 h-5 text-red-600"></i>
        <span>Claims</span>
      </a>

      <a href="{% url 'hospitals:hospital_list' %}" 
         class="sidebar-link flex items-center space-x-3 px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 
         {% if '/hospitals/' in request.path %}active{% endif %}">
        <i data-lucide="building-2" class="w-5 h-5 text-purple-600"></i>
        <span>Hospitals</span>
      </a>

      {% if user.role == 'admin' %}
      <a href="{% url 'admin:index' %}" 
         class="sidebar-link flex items-center space-x-3 px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 
         {% if '/admin/' in request.path %}active{% endif %}">
        <i data-lucide="settings" class="w-5 h-5 text-gray-600"></i>
        <span>Admin Settings</span>
      </a>
      {% endif %}
    </aside>

    <!-- MAIN CONTENT -->
    <main class="flex-1 p-8 bg-gray-50 dark:bg-gray-900 overflow-y-auto">
      {% block content %}{% endblock %}
    </main>
  </div>

  <script>
    lucide.createIcons();

    // Dark Mode Toggle
    const toggle = document.getElementById('darkModeToggle');
    toggle.addEventListener('click', () => {
      document.documentElement.classList.toggle('dark');
      localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
    });

    // Load dark mode preference
    if (localStorage.getItem('darkMode') === 'true') {
      document.documentElement.classList.add('dark');
    }
  </script>
</body>
</html>